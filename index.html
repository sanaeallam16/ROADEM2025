<!DOCTYPE html>
<html lang="fr" data-theme="light" class="hc cb-safe">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ROADEMâ€™25 â€” Programme officiel (modern + PDF)</title>

  <!-- Webfont (Manrope variable fallback) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wdth,wght@95,400..800&display=swap" rel="stylesheet">

  <style>
/* =========================================================
   ROADEMâ€™25 â€” Pro Theme (Blue + Orange, filled sessions)
   r11 â€¢ consolidated print & fit + polish
   ========================================================= */

/* ---------- Design tokens ---------- */
:root{
  /* Base */
  --bg:#f6f7fa;
  --paper:#ffffff;
  --ink:#0f172a;
  --muted:#5b6678;
  --line:#e6e9ef;

  /* Brand (Blue / Orange) */
  --blue-800:#1f3d86;
  --blue-700:#244c9a;
  --blue-600:#2f6ad7;
  --blue-300:#c7d6ff;
  --blue-200:#dbe7ff;
  --blue-100:#eaf1ff;
  --blue-050:#f6f9ff;

  --orange-700:#c06322;
  --orange-600:#e07b2c;
  --orange-400:#f2a564;
  --orange-200:#ffdcbc;
  --orange-100:#ffe9d6;
  --orange-050:#fff6ed;

  --green-600:#2e7d5b;
  --violet-600:#6b5a8e;
  --gold-600:#a4822a;

  /* Accents (subtle) */
  --bar-blue:#a8c2ff;
  --bar-orange:#ffd2a6;
  --bar-green:#8ac1aa;
  --bar-violet:#b1a3c4;
  --bar-gold:#d2be86;

  /* Layout */
  --radius:16px;
  --shadow-sm:0 2px 8px rgba(0,0,0,.04);
  --shadow-md:0 10px 28px rgba(0,0,0,.06);
  --focus:0 0 0 3px rgba(47,106,215,.22);

  --font:"Manrope",system-ui,-apple-system,"Segoe UI",Roboto,sans-serif;
  --fs-base:15px; --lh:1.6; --track:.002em; --tight:-.015em;

  --container:1180px; --gap:18px; --row-pad:12px; --hour-col:130px;
}

/* Dark mode */
@media (prefers-color-scheme: dark){
  :root{
    --bg:#0b1220; --paper:#111827; --ink:#e5e7eb; --muted:#9aa6b8; --line:#2b3340;
    --blue-300:#263463; --blue-200:#1e2b55; --blue-100:#18254a; --blue-050:#121a36;
    --orange-400:#6f4a25; --orange-200:#3b2b1f; --orange-100:#2c1f15; --orange-050:#1e170f;
    --shadow-sm:0 2px 8px rgba(0,0,0,.25); --shadow-md:0 10px 28px rgba(0,0,0,.35);
    --focus:0 0 0 3px rgba(47,106,215,.45);
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *,*::before,*::after{animation:none!important;transition:none!important;scroll-behavior:auto!important}
}

/* ---------- Base ---------- */
*{box-sizing:border-box}
html,body{height:100%}
body{
  font-family:var(--font); font-size:var(--fs-base); line-height:var(--lh); letter-spacing:var(--track);
  color:var(--ink);
  background:
    radial-gradient(1100px 520px at 12% -12%, rgba(47,106,215,.03), transparent 55%),
    radial-gradient(900px 600px at 108% -18%, rgba(224,123,44,.025), transparent 60%),
    var(--bg);
  margin:0; -webkit-font-smoothing:antialiased
}
h1,h2,h3{margin:0; letter-spacing:var(--tight)}
h1{font-size:clamp(28px,3.4vw,46px); font-weight:900}
h2{font-size:clamp(18px,1.7vw,22px); font-weight:800}
a{color:var(--blue-600); text-decoration:none}
a:hover{text-decoration:underline}
.wrap{max-width:var(--container); margin:28px auto 72px; padding:0 16px}

/* Keyboard focus */
:where(a,button,input)[tabindex]:focus-visible,
:where(button,input,.density,.tab,.btn):focus-visible{outline:none; box-shadow:var(--focus)}

/* ---------- Header / Hero ---------- */
.hero{display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:var(--gap)}
.brand{display:contents}
.logo{width:74px;height:74px;border-radius:14px;overflow:hidden;background:#fff;box-shadow:var(--shadow-md);border:1px solid var(--line)}
.logo img{width:100%;height:100%;object-fit:cover}
.heading{display:flex;flex-direction:column;gap:6px}
.kicker{font-weight:800;text-transform:uppercase;color:var(--blue-600);font-size:12px;letter-spacing:.08em}
.subhead{color:var(--muted);font-weight:600;font-size:14px}

.ribbon{display:flex;gap:8px;flex-wrap:wrap}
.btn{
  border:0;border-radius:999px;padding:10px 16px;font-weight:800;cursor:pointer;
  background:linear-gradient(180deg,#fff,#f6f7fb);
  color:var(--ink); box-shadow:var(--shadow-sm);
  transition:transform .15s ease, box-shadow .15s ease, background .2s ease
}
.btn:hover{box-shadow:var(--shadow-md);transform:translateY(-1px)}
#printPortrait{background:linear-gradient(180deg,#fff,var(--blue-050))}

/* ---------- Tabs ---------- */
.tabs{
  position:sticky; top:0; z-index:30; margin:18px 0 0;
  background:rgba(255,255,255,.85); backdrop-filter:blur(8px);
  border-radius:999px; box-shadow:var(--shadow-sm);
  display:flex; justify-content:center; padding:6px
}
.tab{
  border:none; background:transparent; border-radius:999px; padding:10px 18px; font-weight:800;
  color:var(--muted); cursor:pointer; transition:background .2s ease, color .2s ease
}
.tab[aria-selected="true"]{background:linear-gradient(90deg, var(--blue-600), var(--orange-600)); color:#fff}

/* ---------- Cards / Controls ---------- */
.card{background:var(--paper); border-radius:var(--radius); box-shadow:var(--shadow-sm); margin-top:20px; overflow:hidden; border:1px solid var(--line)}
.card h2{padding:16px 20px; color:var(--ink); background:linear-gradient(180deg,#fafbff,#f9fbfe); border-bottom:1px solid var(--line)}
.controls{display:flex; flex-wrap:wrap; align-items:center; gap:10px; padding:12px 16px; border-bottom:1px solid var(--line); background:linear-gradient(180deg,rgba(2,6,23,.02),transparent)}
.pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#f2f4f8;font-weight:700;font-size:12px;color:#0f172a}
.pill .dot{width:10px;height:10px;border-radius:50%}
.dot.blue{background:var(--blue-600)} .dot.orange{background:var(--orange-600)} .dot.violet{background:var(--violet-600)} .dot.gold{background:var(--gold-600)} .dot.green{background:var(--green-600)}
.search{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--line);border-radius:12px;background:#fff}
.search input{border:none;outline:none;min-width:260px;font-size:14px}
.density{border:1px solid var(--line);background:#fff;border-radius:10px;padding:6px 10px;font-weight:800;cursor:pointer}
.density[aria-pressed="true"]{background:#eef2ff;border-color:#c7d2fe}

/* ---------- Table ---------- */
.table-wrap{overflow-x:auto}
table{width:100%;border-collapse:collapse;border-spacing:0;table-layout:auto}
thead th{
  text-align:left;padding:10px 14px;font-size:12px;text-transform:uppercase;letter-spacing:.05em;
  color:var(--muted); background:var(--blue-100); position:sticky; top:0; border-bottom:1px solid var(--line); z-index:3
}
thead::after{content:"";position:sticky;top:0;display:block;height:0;box-shadow:0 1px 0 rgba(0,0,0,.05)}
tbody td{padding:var(--row-pad) 14px;border-bottom:1px solid var(--line);background:var(--paper);transition:background .18s ease}
tbody tr:nth-child(odd) td{background:#fbfdff}
tbody tr:hover td{background:var(--blue-050)}
/* Sticky first column */
thead th:first-child, tbody td:first-child{
  position:sticky; left:0; z-index:2; width:var(--hour-col);
  background:linear-gradient(#fff,#fbfdff); box-shadow:1px 0 0 var(--line);
  font-variant-numeric:tabular-nums; white-space:nowrap
}
/* Cell internals */
.cell{display:grid;gap:3px}
.cell .title{font-weight:800;letter-spacing:-.01em}
.cell .sub{color:var(--muted);font-weight:600;font-size:13px}
.chips{display:flex;gap:6px;flex-wrap:wrap;margin-top:4px}
.tag{font-size:11px;font-weight:800;padding:4px 8px;border-radius:999px;background:#eef2ff;color:var(--blue-700)}
.room{font-weight:800}
/* Type badges */
.type{display:inline-block;padding:6px 10px;border-radius:8px;font-size:11px;font-weight:800;color:#fff;text-transform:uppercase;letter-spacing:.04em}
.k-blue{background:var(--blue-600)} .k-green{background:var(--green-600)} .k-violet{background:var(--violet-600)} .k-orange{background:var(--orange-600)} .k-gold{background:var(--gold-600)}
/* Left accents â€” primary */
tbody tr:has(.k-blue)  > td[data-col="activity"]{border-left:3px solid var(--bar-blue);  padding-left:12px}
tbody tr:has(.k-orange)> td[data-col="activity"]{border-left:3px solid var(--bar-orange);padding-left:12px}
tbody tr:has(.k-green) > td[data-col="activity"]{border-left:3px solid var(--bar-green); padding-left:12px}
tbody tr:has(.k-violet)> td[data-col="activity"]{border-left:3px solid var(--bar-violet);padding-left:12px}
tbody tr:has(.k-gold)  > td[data-col="activity"]{border-left:3px solid var(--bar-gold);  padding-left:12px}
/* Fallback by data-type (si :has non supportÃ©) */
tr[data-type*="pleniere"]  > td[data-col="activity"]{border-left:3px solid var(--bar-blue)}
tr[data-type*="session"]   > td[data-col="activity"]{border-left:3px solid var(--bar-green)}
tr[data-type*="poster"]    > td[data-col="activity"]{border-left:3px solid var(--bar-violet)}
tr[data-type*="pause"]     > td[data-col="activity"]{border-left:3px solid var(--bar-orange)}
tr[data-type*="cloture"]   > td[data-col="activity"]{border-left:3px solid var(--bar-gold)}

/* ---------- Sessions inline (filled, no border) ---------- */
.sessions-inline-td{padding:0 !important}
.sessions-inline{
  display:grid; grid-template-columns:repeat(4,1fr); gap:10px; padding:10px;
  background:#f7f9ff;
}
.session-cell{
  border:none; border-radius:12px; padding:12px 14px; font-weight:800; box-shadow:var(--shadow-sm);
  line-height:1.35;
}
.s1{ background:var(--blue-200);   color:#0a1530 }
.s2{ background:var(--orange-200); color:#2a1606 }
.s3{ background:var(--blue-100);   color:#0a1530 }
.s4{ background:var(--orange-100); color:#2a1606 }
.session-cell:focus-visible{outline:2px solid var(--blue-300); outline-offset:2px}
.session-cell:hover{filter:brightness(0.98)}
.session-cell b{color:inherit}

/* Speaker highlight */
.speaker{display:inline-flex;align-items:center;gap:6px;padding:2px 8px;border-radius:999px;background:var(--orange-100);color:#111827;font-weight:900}
.speaker::before{content:"ðŸŽ¤";font-size:12px}

/* Avoid page breaks inside rows */
tbody tr{break-inside:avoid; page-break-inside:avoid}

/* ---------- Density presets ---------- */
:root[data-density="compact"]{ --row-pad:8px }
:root[data-density="comfortable"]{ --row-pad:12px }

/* ---------- Responsive ---------- */
@media (max-width:1200px){ :root{ --hour-col:120px } }
@media (max-width:760px){
  .hero{grid-template-columns:1fr; gap:12px}
  .ribbon{order:3}
  thead{display:none}
  tbody, tr, td{display:block; width:100%}
  tbody tr{margin:12px 0; border:1px solid var(--line); border-radius:12px; box-shadow:var(--shadow-sm); overflow:hidden; background:#fff}
  tbody td{border:none; display:grid; grid-template-columns:40% 1fr; gap:10px; align-items:start}
  tbody td::before{content:attr(data-label); font-weight:900; color:var(--muted); text-transform:uppercase; font-size:12px}
  .sessions-inline{grid-template-columns:1fr}
}

/* ---------- Print (Portrait standard) ---------- */
@media print{
  @page{size:A4 portrait; margin:10mm}
  html,body{background:#fff !important}
  .tabs,.controls,.ribbon{display:none !important}
  .wrap{margin:0 auto; padding:0; max-width:none}
  *{-webkit-print-color-adjust:exact; print-color-adjust:exact}
  body{font-size:12.3px; line-height:1.35}

  thead{display:table-header-group}
  thead th{
    position:static !important; background:#f3f4f6 !important; border-bottom:1px solid #d1d5db !important; color:#3a4352 !important;
    padding:8px 10px !important; letter-spacing:.06em; text-transform:uppercase; font-weight:800
  }
  tbody td{padding:7px 9px !important; border-bottom:1px solid #e5e7eb !important}

  .card{box-shadow:none !important; margin-top:8px; border:none; page-break-inside:avoid; break-inside:avoid}
  .card h2{background:#f2f5ff !important; color:#0f172a !important; padding:10px 12px !important; border-bottom:1px solid #dfe4ee !important}

  /* 2 colonnes: Heure + ActivitÃ© */
  th[data-col="type"], th[data-col="room"], td[data-col="type"], td[data-col="room"]{display:none !important}
  thead th:first-child{width:32mm !important}
  thead th, tbody td{font-variant-numeric:tabular-nums}

  /* Zebra lisible en NB */
  tbody tr:nth-child(odd) td{background:#fafbff !important}
  tbody tr:nth-child(even) td{background:#ffffff !important}

  /* Accent par dÃ©faut bleu, pause en orange */
  td[data-col="activity"]{border-left:3px solid #2f6ad7 !important}
  tbody tr[data-type~="pause"] td[data-col="activity"]{
    text-align:center !important; font-weight:800;
    background:#fff6ed !important; border-left-color:#e07b2c !important
  }

  .sessions-inline{gap:6px; padding:6px}
  .session-cell{padding:6px 8px; box-shadow:none; border:none}

  tr,td,th{page-break-inside:avoid; break-inside:avoid}
  .day + .day{page-break-before:always}
}
  </style>

  <!-- Print overrides injected by JS -->
  <style id="printOverrides"></style>
</head>

<body>
  <div class="wrap">
    <!-- ===== HERO ===== -->
    <header class="hero" role="banner">
      <div class="brand">
        <div class="logo" aria-hidden="true"><img src="./images/logo.png" alt="Logo ROADEM" /></div>
        <div class="heading">
          <div class="kicker">ROADEMâ€™25 Â· ENSA El Jadida</div>
          <h1>Programme de la ConfÃ©rence</h1>
          <p class="subhead">
            2nd International Conference of the Moroccan Association of Operational Research and Decision Support, ROADEMâ€™25<br/>
            on 20 â€“ 21 November 2025
          </p>
        </div>
      </div>
      <div class="ribbon" role="group" aria-label="Actions">
        <button class="btn" id="printPortrait">ðŸ“„ Export PDF â€” A4 Portrait</button>
        <!--button class="btn" id="printPortraitFit">ðŸ“„ Export PDF â€” A4 Portrait (tout sur 1 page)</button-->
      </div>
    </header>

    <!-- ===== DAY TABS ===== -->
    <nav class="tabs" aria-label="Jours">
      <div class="tabs-inner">
        <button class="tab" data-target="#j1" aria-selected="true">Jour 1 â€” Jeudi 20 nov</button>
        <button class="tab" data-target="#j2" aria-selected="false">Jour 2 â€” Vendredi 21 nov</button>
      </div>
    </nav>

    <!-- ===== OPTIONS ===== -->
    <section class="card" aria-label="Options dâ€™affichage">
      <div class="controls">
        <div class="switch" role="group" aria-label="DensitÃ© des lignes">
          <button type="button" class="density" data-mode="comfortable" aria-pressed="true">Confort</button>
          <button type="button" class="density" data-mode="compact" aria-pressed="false">Compact</button>
        </div>
        <label class="search" aria-label="Rechercher dans le planning">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M21 21l-4.2-4.2M10.8 18a7.2 7.2 0 1 1 0-14.4 7.2 7.2 0 0 1 0 14.4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <input id="searchInput" type="search" placeholder="Recherche (activitÃ©, intervenant, salleâ€¦)" />
        </label>
        <div class="legend" aria-hidden="true" style="display:flex;gap:8px;flex-wrap:wrap;">
          <span class="pill"><span class="dot blue"></span> PlÃ©niÃ¨res</span>
          <span class="pill"><span class="dot green"></span> Sessions</span>
          <span class="pill"><span class="dot violet"></span> Posters</span>
          <span class="pill"><span class="dot orange"></span> Pauses</span>
          <span class="pill"><span class="dot gold"></span> ClÃ´ture</span>
        </div>
      </div>
    </section>

    <!-- ===== JOUR 1 ===== -->
    <section class="card day" id="j1" aria-labelledby="j1-h">
      <h2 id="j1-h">Jour 1 â€” Jeudi 20 novembre 2025</h2>
      <div class="table-wrap">
        <table aria-label="Planning Jour 1">
          <caption class="sr-only">DÃ©roulÃ© du jeudi 20 novembre 2025.</caption>
          <thead>
            <tr>
              <th scope="col" style="width:var(--hour-col)">Heure</th>
              <th scope="col" data-col="type">Type</th>
              <th scope="col" data-col="activity">ActivitÃ©</th>
              <th scope="col" data-col="room">Salle</th>
            </tr>
          </thead>
          <tbody>
            <tr data-type="poster">
              <td data-label="Heure"><time datetime="2025-11-20T08:30">08:30 â€“ 09:00</time></td>
              <td data-label="Type" data-col="type"><span class="type k-violet">Posters</span></td>
              <td data-label="ActivitÃ©" data-col="activity">
                <div class="cell"><div class="title">Accueil &amp; mise en place</div><div class="sub">Installation des posters</div><div class="chips"><span class="tag">Check-in</span></div></div>
              </td>
              <td data-label="Salle" data-col="room"><span class="room">Foyer</span></td>
            </tr>
            <tr data-type="pleniere">
              <td data-label="Heure"><time datetime="2025-11-20T09:00">09:00 â€“ 09:45</time></td>
              <td data-label="Type" data-col="type"><span class="type k-blue">PlÃ©niÃ¨re</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">CÃ©rÃ©monie dâ€™ouverture</div><div class="sub">Discours de bienvenue</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Salle plÃ©niÃ¨re</span></td>
            </tr>
            <tr data-type="pause">
              <td data-label="Heure"><time datetime="2025-11-20T09:45">09:45 â€“ 10:15</time></td>
              <td data-label="Type" data-col="type"><span class="type k-orange">Pause</span></td>
              <td data-label="ActivitÃ©" data-col="activity" colspan="2" style="text-align:center"><div class="cell"><div class="title">Pause-cafÃ©</div></div></td>
            </tr>
            <tr data-type="pleniere">
              <td data-label="Heure"><time datetime="2025-11-20T10:15">10:15 â€“ 11:15</time></td>
              <td data-label="Type" data-col="type"><span class="type k-blue">PlÃ©niÃ¨re I</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">ConfÃ©rence</div><div class="sub"><span class="speaker">Pr. Mark SEVAUX</span> (UniversitÃ© de Bretagne-Sud, Lorient, France)</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Amphi A</span></td>
            </tr>
            <tr data-type="pleniere">
              <td data-label="Heure"><time datetime="2025-11-20T11:15">11:15 â€“ 12:15</time></td>
              <td data-label="Type" data-col="type"><span class="type k-blue">PlÃ©niÃ¨re II</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">ConfÃ©rence</div><div class="sub"><span class="speaker">Pr. Abdellatif EL AFIA</span> (ENSIAS, University Mohammed V, Rabat, Morocco)</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Amphi A</span></td>
            </tr>
            <tr data-type="pleniere">
              <td data-label="Heure"><time datetime="2025-11-20T12:15">12:15 â€“ 13:15</time></td>
              <td data-label="Type" data-col="type"><span class="type k-blue">PlÃ©niÃ¨re III</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">ConfÃ©rence</div><div class="sub"><span class="speaker">ConfÃ©rencier professionnel</span> du TAQA Maroc</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Amphi A</span></td>
            </tr>
            <tr data-type="pause">
              <td data-label="Heure"><time datetime="2025-11-20T13:15">13:15 â€“ 14:20</time></td>
              <td data-label="Type" data-col="type"><span class="type k-orange">Pause</span></td>
              <td data-label="ActivitÃ©" data-col="activity" colspan="2" style="text-align:center"><div class="cell"><div class="title">DÃ©jeuner</div></div></td>
            </tr>
            <tr data-type="session">
              <td data-label="Heure"><time datetime="2025-11-20T14:20">14:20 â€“ 15:00</time></td>
              <td data-label="Type" data-col="type"><span class="type k-green">Sessions</span></td>
              <td data-label="ActivitÃ©" data-col="activity" class="sessions-inline-td" colspan="2">
                <div class="sessions-inline" role="group" aria-label="Sessions parallÃ¨les" data-palette="duo">
                  <div class="session-cell s1"><b>Session I</b> â€” Supply Chain, Logistics &amp; Transport</div>
                  <div class="session-cell s2"><b>Session II</b> â€” Advanced Technologies &amp; Digitalization</div>
                  <div class="session-cell s3"><b>Session III</b> â€” Engineering &amp; Industrial Systems</div>
                  <div class="session-cell s4"><b>Session IV</b> â€” Energy, Environment, Materials &amp; Advanced Manufacturing</div>
                </div>
              </td>
            </tr>
            <tr data-type="poster pause">
              <td data-label="Heure"><time datetime="2025-11-20T15:00">15:00 â€“ 15:30</time></td>
              <td data-label="Type" data-col="type"><span class="type k-violet">Posters I</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">Posters &amp; Pause-cafÃ©</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Foyer</span></td>
            </tr>
            <tr data-type="session">
              <td data-label="Heure"><time datetime="2025-11-20T15:30">15:30 â€“ 16:15</time></td>
              <td data-label="Type" data-col="type"><span class="type k-green">Table ronde</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">Table ronde</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Amphi B</span></td>
            </tr>
            <tr data-type="pleniere">
              <td data-label="Heure"><time datetime="2025-11-20T16:15">16:15 â€“ 16:45</time></td>
              <td data-label="Type" data-col="type"><span class="type k-blue">PlÃ©niÃ¨re IV</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">ConfÃ©rence</div><div class="sub"><span class="speaker">Mr. Noredine EL KINANI</span> (FOUNDER &amp; CEO chez DIGITAL HOUSE GROUP)</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Amphi A</span></td>
            </tr>
            <tr data-type="poster pause">
              <td data-label="Heure"><time datetime="2025-11-20T16:45">16:45 â€“ 17:00</time></td>
              <td data-label="Type" data-col="type"><span class="type k-violet">Posters II</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">Posters &amp; Pause-cafÃ©</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Foyer</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ===== JOUR 2 ===== -->
    <section class="card day" id="j2" aria-labelledby="j2-h">
      <h2 id="j2-h">Jour 2 â€” Vendredi 21 novembre 2025</h2>
      <div class="table-wrap">
        <table aria-label="Planning Jour 2">
          <caption class="sr-only">DÃ©roulÃ© du vendredi 21 novembre 2025.</caption>
          <thead>
            <tr>
              <th scope="col" style="width:var(--hour-col)">Heure</th>
              <th scope="col" data-col="type">Type</th>
              <th scope="col" data-col="activity">ActivitÃ©</th>
              <th scope="col" data-col="room">Salle</th>
            </tr>
          </thead>
          <tbody>
            <tr data-type="pleniere">
              <td data-label="Heure"><time datetime="2025-11-21T08:30">08:30 â€“ 09:00</time></td>
              <td data-label="Type" data-col="type"><span class="type k-blue">PlÃ©niÃ¨re I</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">ConfÃ©rence</div><div class="sub"><span class="speaker">Pr. M-Lounes BENTAHA</span> (LumiÃ¨re University Lyon II, France)</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Amphi A</span></td>
            </tr>
            <tr data-type="pleniere">
              <td data-label="Heure"><time datetime="2025-11-21T09:00">09:00 â€“ 09:45</time></td>
              <td data-label="Type" data-col="type"><span class="type k-blue">PlÃ©niÃ¨re II</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">ConfÃ©rence</div><div class="sub"><span class="speaker">Pr. Karim ZKIK</span> (HDR â€“ Rennes School of Business / Rennes, Bretagne, France)</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Amphi A</span></td>
            </tr>
            <tr data-type="pause">
              <td data-label="Heure"><time datetime="2025-11-21T09:45">09:45 â€“ 10:15</time></td>
              <td data-label="Type" data-col="type"><span class="type k-orange">Pause</span></td>
              <td data-label="ActivitÃ©" data-col="activity" colspan="2" style="text-align:center"><div class="cell"><div class="title">Pause-cafÃ©</div></div></td>
            </tr>
            <tr data-type="session">
              <td data-label="Heure"><time datetime="2025-11-21T10:15">10:15 â€“ 11:00</time></td>
              <td data-label="Type" data-col="type"><span class="type k-green">Sessions</span></td>
              <td data-label="ActivitÃ©" data-col="activity" class="sessions-inline-td" colspan="2">
                <div class="sessions-inline" role="group" aria-label="Sessions parallÃ¨les" data-palette="duo">
                  <div class="session-cell s1"><b>Session I</b> â€” Supply Chain, Logistics &amp; Transport</div>
                  <div class="session-cell s2"><b>Session II</b> â€” Advanced Technologies &amp; Digitalization</div>
                  <div class="session-cell s3"><b>Session III</b> â€” Engineering &amp; Industrial Systems</div>
                  <div class="session-cell s4"><b>Session IV</b> â€” Energy, Environment, Materials &amp; Advanced Manufacturing</div>
                </div>
              </td>
            </tr>
            <tr data-type="session">
              <td data-label="Heure"><time datetime="2025-11-21T11:00">11:00 â€“ 12:30</time></td>
              <td data-label="Type" data-col="type"><span class="type k-green">Table ronde</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">Table ronde</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Amphi B</span></td>
            </tr>
            <tr data-type="pause">
              <td data-label="Heure"><time datetime="2025-11-21T13:15">13:15 â€“ 14:20</time></td>
              <td data-label="Type" data-col="type"><span class="type k-orange">Pause</span></td>
              <td data-label="ActivitÃ©" data-col="activity" colspan="2" style="text-align:center"><div class="cell"><div class="title">DÃ©jeuner</div></div></td>
            </tr>
            <tr data-type="pleniere">
              <td data-label="Heure"><time datetime="2025-11-21T14:20">14:20 â€“ 15:45</time></td>
              <td data-label="Type" data-col="type"><span class="type k-blue">PlÃ©niÃ¨re III</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">ConfÃ©rence</div><div class="sub"><span class="speaker">Pr. Ahmed EL HILALI ALAOUI</span> (Director, School of Digital Engineering &amp; AI, Euromed University, FÃ¨s)</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Amphi A</span></td>
            </tr>
            <tr data-type="pause">
              <td data-label="Heure"><time datetime="2025-11-21T15:45">15:45 â€“ 16:00</time></td>
              <td data-label="Type" data-col="type"><span class="type k-orange">Interpause</span></td>
              <td data-label="ActivitÃ©" data-col="activity" colspan="2" style="text-align:center">Interpause</td>
            </tr>
            <tr data-type="poster pause">
              <td data-label="Heure"><time datetime="2025-11-21T16:00">16:00 â€“ 16:45</time></td>
              <td data-label="Type" data-col="type"><span class="type k-violet">Posters II</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">Posters &amp; Pause-cafÃ©</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Foyer</span></td>
            </tr>
            <tr data-type="cloture">
              <td data-label="Heure"><time datetime="2025-11-21T16:45">16:45 â€“ 17:00</time></td>
              <td data-label="Type" data-col="type"><span class="type k-gold">ClÃ´ture</span></td>
              <td data-label="ActivitÃ©" data-col="activity"><div class="cell"><div class="title">ClÃ´ture &amp; remerciements</div></div></td>
              <td data-label="Salle" data-col="room"><span class="room">Salle plÃ©niÃ¨re</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>

  <script>
    /* ===== Helpers ===== */
    const $ = (s,root=document)=>root.querySelector(s);
    const $$ = (s,root=document)=>[...root.querySelectorAll(s)];

    /* ===== Density toggle ===== */
    const densityBtns = $$('.density');
    const setDensity = (mode)=>{
      document.documentElement.style.setProperty('--row-pad', mode==='compact'?'8px':'12px');
      densityBtns.forEach(b=> b.setAttribute('aria-pressed', b.dataset.mode===mode ? 'true':'false'));
    };
    densityBtns.forEach(b=> b.addEventListener('click',()=> setDensity(b.dataset.mode)));
    setDensity('comfortable');

    /* ===== Global search (accent-insensitive) ===== */
    const norm = s => (s||'').toLowerCase().normalize('NFD').replace(/\p{Diacritic}/gu,'');
    const rows = $$('.day tbody tr');
    $('#searchInput')?.addEventListener('input', e=>{
      const q = norm(e.target.value);
      rows.forEach(r=>{ r.style.display = norm(r.innerText).includes(q) ? '' : 'none'; });
    });

    /* ===== Merge & center breaks (Pause / DÃ©jeuner) ===== */
    $$('.day tbody').forEach(tbody=>{
      [...tbody.rows].forEach(row=>{
        const types = (row.getAttribute('data-type')||'').split(/\s+/);
        if(types.includes('pause')){
          const cells = row.querySelectorAll('td');
          if(cells.length>=4){
            const act=cells[2]; const room=cells[3];
            act.setAttribute('colspan','2'); if(room) room.remove();
            act.style.textAlign='center';
          }
        }
      });
    });

    /* ===== Tabs (Day switcher â†’ scroll to section) ===== */
    $$('.tab').forEach(tab=>{
      tab.addEventListener('click',()=>{
        $$('.tab').forEach(t=> t.setAttribute('aria-selected','false'));
        tab.setAttribute('aria-selected','true');
        const target = tab.dataset.target;
        document.querySelector(target)?.scrollIntoView({behavior:'smooth', block:'start'});
      });
    });

    /* ===== Print core utils (single source of truth) ===== */
    function getPrintStyleEl(){
      let el=document.getElementById('printOverrides');
      if(!el){el=document.createElement('style');el.id='printOverrides';document.head.appendChild(el)}
      return el;
    }
    function applyPrint(css,{label='PDF Export',trigger}={}){
      const styleEl=getPrintStyleEl(), prevTitle=document.title, prevScrollY=window.scrollY;
      if(trigger&&typeof trigger.disabled==='boolean') trigger.disabled=true;
      document.title=`${prevTitle} â€” ${label}`; styleEl.textContent=css;

      const after=()=>cleanup('afterprint'); window.addEventListener('afterprint',after,{once:true});
      const mq=window.matchMedia?window.matchMedia('print'):null; let h;
      if(mq&&typeof mq.addEventListener==='function'){h=e=>{if(!e.matches) cleanup('mq end')}; mq.addEventListener('change',h)}
      const t=setTimeout(()=>cleanup('timeout'),8000);
      try{window.print()}catch(e){console.error(e)}

      function cleanup(){
        clearTimeout(t); window.removeEventListener('afterprint',after); if(mq&&h) mq.removeEventListener('change',h);
        styleEl.textContent=''; document.title=prevTitle; window.scrollTo({top:prevScrollY,behavior:'instant'});
        if(trigger&&typeof trigger.disabled==='boolean') setTimeout(()=>trigger.disabled=false,150);
        const w=document.getElementById('print-fit-wrap'); if(w){const inner=w.firstChild; w.replaceWith(inner)}
      }
    }

    /* ===== A4 constants (CSS px @96DPI) ===== */
    const A4W = 210/25.4*96; // ~794px
    const A4H = 297/25.4*96; // ~1123px

    /* ===== Portrait standard (marges 10mm, 2 colonnes) ===== */
    function printPortrait(ev){
      const css = `
        @media print{
          @page{ size:A4 portrait; margin:10mm }
          html,body{ background:#fff !important }
          .tabs,.controls,.ribbon,.legend{ display:none !important }
          .wrap{ margin:0; padding:0; max-width:none }
          *{-webkit-print-color-adjust:exact; print-color-adjust:exact }

          thead{ display:table-header-group }
          /* neutraliser sticky/ombres */
          thead th, tbody td, thead th:first-child, tbody td:first-child{
            position:static !important; box-shadow:none !important; background:#fff;
          }
          thead th{
            background:#eef2ff !important; color:#0f172a !important;
            text-transform:uppercase; letter-spacing:.06em; font-weight:800;
            border-bottom:1px solid #d1d5db !important; padding:8px 10px !important;
          }
          tbody td{ padding:8px 10px !important; border-bottom:1px solid #e5e7eb !important }

          /* 2 colonnes (Heure + ActivitÃ©) */
          th[data-col="type"], th[data-col="room"],
          td[data-col="type"], td[data-col="room"]{ display:none !important }
          thead th:first-child{ width:32mm !important }
          thead th, tbody td{ font-variant-numeric:tabular-nums }

          /* zÃ©brage & accents */
          tbody tr:not([data-type~="pause"]):nth-child(odd) td{ background:#fafbff !important }
          tbody tr:not([data-type~="pause"]):nth-child(even) td{ background:#ffffff !important }
          td[data-col="activity"]{ border-left:3px solid #2f6ad7 !important }
          tbody tr[data-type~="pause"] td{
            background:#fff6ed !important; border-bottom-color:#f2e4d6 !important;
          }
          tbody tr[data-type~="pause"] td[data-col="activity"]{
            border-left-color:#e07b2c !important; text-align:center !important; font-weight:800;
          }

          .sessions-inline-td{ padding:0 !important }
          .sessions-inline{ gap:6px; padding:6px; background:#f7f9ff !important }
          .session-cell{ padding:6px 8px; box-shadow:none; border:none }

          tr,td,th{ page-break-inside:avoid; break-inside:avoid }
          .day + .day{ page-break-before:always }
        }
      `;
      applyPrint(css,{label:'PDF (A4 Portrait)',trigger:ev?.currentTarget||document.getElementById('printPortrait')});
    }

    /* ===== Portrait "tout sur 1 page" (marges 0 + scale) ===== */
    function printPortraitFit(ev){
      const activeTab = document.querySelector('.tab[aria-selected="true"]');
      const targetSel = activeTab?.dataset?.target || '#j1';
      const day = document.querySelector(targetSel) || document.querySelector('#j1');
      if(!day) return;

      const wrap = document.createElement('div');
      wrap.id = 'print-fit-wrap';
      day.parentNode.insertBefore(wrap, day);
      wrap.appendChild(day);

      const safe = 6; // petite marge interne
      const rect = day.getBoundingClientRect();
      const scaleW = (A4W - safe*2) / rect.width;
      const scaleH = (A4H - safe*2) / rect.height;
      const scale = Math.min(1, scaleW, scaleH);

      const css = `
        @media print{
          @page{ size:A4 portrait; margin:0 }
          html,body{ background:#fff !important }
          .tabs,.controls,.ribbon,.legend{ display:none !important }
          .wrap{ margin:0; padding:0; max-width:none }
          *{-webkit-print-color-adjust:exact; print-color-adjust:exact }

          thead{ display:table-header-group }
          thead th, tbody td, thead th:first-child, tbody td:first-child{
            position:static !important; box-shadow:none !important; background:#fff;
          }

          /* 2 colonnes */
          th[data-col="type"], th[data-col="room"],
          td[data-col="type"], td[data-col="room"]{ display:none !important }
          thead th{
            background:#eef2ff !important; color:#0f172a !important;
            text-transform:uppercase; letter-spacing:.06em; font-weight:800;
            border-bottom:1px solid #d1d5db !important; padding:8px 10px !important;
          }
          tbody td{ padding:8px 10px !important; border-bottom:1px solid #e5e7eb !important }

          /* aplats & accents */
          tbody tr:not([data-type~="pause"]):nth-child(odd) td{ background:#fafbff !important }
          tbody tr:not([data-type~="pause"]):nth-child(even) td{ background:#ffffff !important }
          td[data-col="activity"]{ border-left:3px solid #2f6ad7 !important }
          tbody tr[data-type~="pause"] td{ background:#fff6ed !important; border-bottom-color:#f2e4d6 !important }
          tbody tr[data-type~="pause"] td[data-col="activity"]{ border-left-color:#e07b2c !important; text-align:center !important; font-weight:800 }

          .sessions-inline-td{ padding:0 !important }
          .sessions-inline{ gap:6px; padding:6px; background:#f7f9ff !important }
          .session-cell{ padding:6px 8px; box-shadow:none; border:none }

          tr,td,th{ page-break-inside:avoid; break-inside:avoid }
        }
        @media print{
          #print-fit-wrap{
            transform:scale(${scale});
            transform-origin: top left;
            width:${rect.width}px;
            height:${rect.height}px;
            padding:${safe}px;
          }
        }
      `;
      applyPrint(css,{label:'PDF (A4 â€“ tout le tableau)',trigger:ev?.currentTarget||document.getElementById('printPortraitFit')});
    }

    /* ===== Bind buttons ===== */
    document.getElementById('printPortrait')?.addEventListener('click', printPortrait);
    document.getElementById('printPortraitFit')?.addEventListener('click', printPortraitFit);
  </script>
</body>
</html>
